<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <base href="/">

    <title>
        
        New Website &mdash; aziis98.com
        
    </title>

    <meta name="description" content="New website generated with a Makefile">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="icon" type="image/png" sizes="192x192" href="static/icon-192x192.png">

    <meta property="og:title" content="New Website">
    <meta property="og:description" content="New website generated with a Makefile">
    <meta property="og:image" content="static/icon-192x192.png" />

    

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <link rel="stylesheet" href="static/css/style.css">
    <link rel="stylesheet" href="static/css/lovelace.css">

    <link 
        rel="stylesheet" 
        href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"
        integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
    <script 
        defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js"
        integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" 
        crossorigin="anonymous"></script>
        
    <script type="module">
        Array.prototype.forEach.call(document.querySelectorAll('.math.inline'), $el => {
            console.log($el.innerText);
            katex.render($el.innerText, $el, { displayMode: false });
        });
        Array.prototype.forEach.call(document.querySelectorAll('.math.display'), $el => {
            katex.render($el.innerText, $el, { displayMode: true });
        });
    </script>

</head>

<body>
    <div class="nav-wrapper">
        <input type="checkbox" id="toggle-menu">
        <label for="toggle-menu">
            <span class="material-icons menu">menu</span>
            <span class="material-icons close">close</span>
        </label>
        <nav>
            <a class="logo" href="/" title="aziis98.com">
                <svg width="100%" height="100%" viewBox="0 0 1000 1000">
                    <g style="stroke-width:0.857654" transform="matrix(1.165971,0,0,1.165971,-82.985498,-82.985496)"
                       id="layer1">
                        <path d="m 370.35583,737.36325 52.42963,-138.22357 c 4.76633,-12.39246 10.48592,-16.20552 33.36431,-16.20552 h 198.27932 l 58.14923,161.10195 c 13.34572,40.03717 -25.73818,36.22411 -70.54168,39.08391 -5.7196,5.71959 -5.7196,25.73818 0,31.45778 35.27084,-0.95327 87.70047,-1.90654 124.87784,-1.90654 39.08391,0 73.40148,0.95327 108.67232,1.90654 5.7196,-5.7196 5.7196,-25.73819 0,-31.45778 -37.17737,-2.8598 -68.63515,-2.8598 -85.79394,-52.42963 L 594.37334,214.02022 c -5.7196,-9.53266 -7.62613,-16.20552 -14.29899,-27.64471 -50.5231,0.95326 -121.06478,0.95326 -129.64418,-0.95327 -5.71959,7.62613 -8.57939,8.5794 -19.06532,34.31758 L 219.7398,715.43813 c -25.73818,59.10249 -54.33616,64.82209 -95.3266,67.68189 -5.71959,5.71959 -5.71959,25.73818 0,31.45778 35.27084,-0.95327 47.6633,-1.90654 84.84068,-1.90654 39.0839,0 191.60646,0.95327 226.8773,1.90654 5.7196,-5.7196 5.7196,-25.73819 0,-31.45778 -36.22411,-1.90653 -81.02761,-5.7196 -65.77535,-45.75677 z M 473.30856,542.89699 c -21.92512,0 -28.59798,-1.90653 -24.78492,-12.39246 L 544.8035,288.37497 h 1.90654 l 92.4668,254.52202 z M 508.5794,205.44083 h 45.75676 L 323.64579,784.07328 h -49.56983 z"
                              style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-family:Arial;-inkscape-font-specification:Arial;fill:#000000;fill-opacity:1;stroke:none;stroke-width:4.28826"
                              id="path836" />
                    </g>
                </svg>
            </a>
            <div class="nav-group">
                <a id="nav-unipi" style="display: none;" class="nav-link" href="page/unipi.html">Università</a>
                <a class="nav-link" href="">Posts</a>
                <a class="nav-link" href="page/about.html">About</a>
            </div>
        </nav>
    </div>
    <main>

        <article>
    <header class="post-header">
        <h1 class="post-title">New Website</h1>
        <div class="post-date">
            Posted on the 
            <span>2020/08/29</span>
            by
            <a href="" rel="author">Antonio De Lucreziis</a>
        </div>
        <p class="post-tags">
            
            <a href="tags/makefile.html" class="tag">#makefile</a>
            
            <a href="tags/markdown.html" class="tag">#markdown</a>
            
            <a href="tags/katex.html" class="tag">#katex</a>
            
        </p>
    </header>

    <p>This is my new website, the source code is hosted on Github at <a href="https://github.com/aziis98/website-2020" class="uri">https://github.com/aziis98/website-2020</a>. It is build all using a single (not too long) Makefile by processing all the markdown file using <a href="https://github.com/aziis98/gotemplater">gotemplater</a> (a cli utility I made, more of this later) and <a href="https://pandoc.org/MANUAL.html">pandoc</a>.</p>
<h3 id="gotemplater">gotemplater</h3>
<p>I made just for this project but I’m probably goint to use it very for this kind of things.</p>
<p>I use it by piping content in standard input and providing a file to a Go template file and this produces a rendered Go template on standard output (there are also various options for telling were to get input from and where to output to). Still this is just one pretty short Go file.</p>
<h2 id="makefile">Makefile</h2>
<p>The complete Makefile can be found <a href="https://github.com/aziis98/website-2020/blob/master/Makefile">here</a>. Now I will try to explain more or less how the generation works.</p>
<h3 id="variables">Variables</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode makefile"><code class="sourceCode makefile"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a><span class="dt">OUT </span><span class="ch">=</span><span class="st"> dist</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a><span class="dt">CACHE </span><span class="ch">=</span><span class="st"> .cache</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true"></a><span class="dt">PAGES     </span><span class="ch">=</span><span class="st"> </span><span class="ch">$(</span><span class="kw">wildcard</span><span class="st"> src/page/*</span><span class="ch">)</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true"></a><span class="dt">PAGES_OUT </span><span class="ch">=</span><span class="st"> </span><span class="ch">$(</span><span class="kw">patsubst</span><span class="st"> src/page/%.html</span><span class="kw">,</span><span class="st"> </span><span class="ch">$(</span><span class="dt">OUT</span><span class="ch">)</span><span class="st">/page/%.html</span><span class="kw">,</span><span class="st"> </span><span class="ch">$(</span><span class="dt">PAGES</span><span class="ch">))</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true"></a><span class="dt">POSTS      </span><span class="ch">=</span><span class="st"> </span><span class="ch">$(</span><span class="kw">wildcard</span><span class="st"> src/post/*</span><span class="ch">)</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true"></a><span class="dt">POSTS_REFS </span><span class="ch">=</span><span class="st"> </span><span class="ch">$(</span><span class="kw">patsubst</span><span class="st"> src/post/%.md</span><span class="kw">,</span><span class="st"> %</span><span class="kw">,</span><span class="st"> </span><span class="ch">$(</span><span class="dt">POSTS</span><span class="ch">))</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true"></a><span class="dt">POSTS_OUT </span><span class="ch">=</span><span class="st"> </span><span class="ch">$(</span><span class="kw">patsubst</span><span class="st"> src/post/%.md</span><span class="kw">,</span><span class="st"> </span><span class="ch">$(</span><span class="dt">OUT</span><span class="ch">)</span><span class="st">/post/%.html</span><span class="kw">,</span><span class="st"> </span><span class="ch">$(</span><span class="dt">POSTS</span><span class="ch">))</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true"></a><span class="dt">POSTS_BUILD_MARKDOWN </span><span class="ch">=</span><span class="st"> </span><span class="ch">$(</span><span class="kw">patsubst</span><span class="st"> src/post/%.md</span><span class="kw">,</span><span class="st"> </span><span class="ch">$(</span><span class="dt">CACHE</span><span class="ch">)</span><span class="st">/post/%.md</span><span class="kw">,</span><span class="st"> </span><span class="ch">$(</span><span class="dt">POSTS</span><span class="ch">))</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true"></a><span class="dt">POSTS_BUILD_YAML     </span><span class="ch">=</span><span class="st"> </span><span class="ch">$(</span><span class="kw">patsubst</span><span class="st"> src/post/%.md</span><span class="kw">,</span><span class="st"> </span><span class="ch">$(</span><span class="dt">CACHE</span><span class="ch">)</span><span class="st">/post/%.yaml</span><span class="kw">,</span><span class="st"> </span><span class="ch">$(</span><span class="dt">POSTS</span><span class="ch">))</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true"></a><span class="dt">POSTS_BUILD_HTML     </span><span class="ch">=</span><span class="st"> </span><span class="ch">$(</span><span class="kw">patsubst</span><span class="st"> src/post/%.md</span><span class="kw">,</span><span class="st"> </span><span class="ch">$(</span><span class="dt">CACHE</span><span class="ch">)</span><span class="st">/post/%.html</span><span class="kw">,</span><span class="st"> </span><span class="ch">$(</span><span class="dt">POSTS</span><span class="ch">))</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true"></a><span class="dt">POSTS_BUILD_TAGS </span><span class="ch">=</span><span class="st"> </span><span class="ch">$(</span><span class="kw">patsubst</span><span class="st"> src/post/%.md</span><span class="kw">,</span><span class="st"> </span><span class="ch">$(</span><span class="dt">CACHE</span><span class="ch">)</span><span class="st">/tags/%.tag</span><span class="kw">,</span><span class="st"> </span><span class="ch">$(</span><span class="dt">POSTS</span><span class="ch">))</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true"></a><span class="dt">TAGS_PATH </span><span class="ch">=</span><span class="st"> </span><span class="ch">$(</span><span class="dt">CACHE</span><span class="ch">)</span><span class="st">/tags/*.tag</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true"></a><span class="cf">ifeq</span> (<span class="ch">$(</span><span class="dt">MODE</span><span class="ch">)</span>, dev)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true"></a><span class="ot">.PRECIOUS:</span><span class="dt"> </span><span class="ch">$(</span><span class="dt">POSTS_BUILD_MARKDOWN</span><span class="ch">)</span><span class="dt"> </span><span class="ch">$(</span><span class="dt">POSTS_BUILD_YAML</span><span class="ch">)</span><span class="dt"> </span><span class="ch">$(</span><span class="dt">POSTS_BUILD_HTML</span><span class="ch">)</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true"></a><span class="cf">endif</span></span></code></pre></div>
<h3 id="main-targets">Main Targets</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode makefile"><code class="sourceCode makefile"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a><span class="ot">.PHONY:</span><span class="dt"> all</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a><span class="dv">all:</span><span class="dt"> clean pages posts assets tags </span><span class="ch">$(</span><span class="dt">OUT</span><span class="ch">)</span><span class="dt">/index.html</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true"></a><span class="ot">.PHONY:</span><span class="dt"> content</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true"></a><span class="dv">content:</span><span class="dt"> pages posts assets </span><span class="ch">$(</span><span class="dt">OUT</span><span class="ch">)</span><span class="dt">/index.html</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true"></a><span class="ot">.PHONY:</span><span class="dt"> pages</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true"></a><span class="dv">pages:</span><span class="dt"> </span><span class="ch">$(</span><span class="dt">PAGES_OUT</span><span class="ch">)</span><span class="dt"> </span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true"></a><span class="ot">.PHONY:</span><span class="dt"> posts</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true"></a><span class="dv">posts:</span><span class="dt"> </span><span class="ch">$(</span><span class="dt">POSTS_OUT</span><span class="ch">)</span><span class="dt"> </span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true"></a><span class="ot">.PHONY:</span><span class="dt"> assets</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true"></a><span class="dv">assets:</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true"></a>    cp -r src/static <span class="ch">$(</span><span class="dt">OUT</span><span class="ch">)</span>/</span></code></pre></div>
<h3 id="output-targets">Output Targets</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode makefile"><code class="sourceCode makefile"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a><span class="co"># Generate Pages</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true"></a><span class="dv">$(OUT)/page/%.html:</span><span class="dt"> src/page/%.html</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true"></a>    gotemplater -c <span class="ch">$&lt;</span> layouts/_base.html &gt; <span class="ch">$@</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true"></a><span class="co"># Generate Posts</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true"></a><span class="dv">$(OUT)/post/%.html:</span><span class="dt"> </span><span class="ch">$(</span><span class="dt">CACHE</span><span class="ch">)</span><span class="dt">/post/%.html </span><span class="ch">$(</span><span class="dt">CACHE</span><span class="ch">)</span><span class="dt">/post/%.yaml</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true"></a>    gotemplater -f yaml -d <span class="ch">$(</span><span class="dt">CACHE</span><span class="ch">)</span>/post/<span class="ch">$*</span>.yaml -c <span class="ch">$(</span><span class="dt">CACHE</span><span class="ch">)</span>/post/<span class="ch">$*</span>.html layouts/post.html | <span class="ch">\</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true"></a>        gotemplater -f yaml -d <span class="ch">$(</span><span class="dt">CACHE</span><span class="ch">)</span>/post/<span class="ch">$*</span>.yaml -c - layouts/_base.html &gt; <span class="ch">$@</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true"></a><span class="co"># Generate Homepage</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true"></a><span class="dv">$(OUT)/index.html:</span><span class="dt"> layouts/index.html </span><span class="ch">$(</span><span class="dt">CACHE</span><span class="ch">)</span><span class="dt">/posts.json</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true"></a>    gotemplater -d <span class="ch">$(</span><span class="dt">CACHE</span><span class="ch">)</span>/posts.json layouts/index.html | <span class="ch">\</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true"></a>        gotemplater -c - layouts/_base.html &gt; <span class="ch">$@</span></span></code></pre></div>
<h3 id="intermediate-targets">Intermediate Targets</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode makefile"><code class="sourceCode makefile"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a><span class="dv">$(CACHE)/posts.json:</span><span class="dt"> </span><span class="ch">$(</span><span class="dt">CACHE</span><span class="ch">)</span><span class="dt">/post/posts</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a>    <span class="ch">@</span><span class="fu">jq -R </span><span class="st">&#39;{ posts: [ inputs | fromjson ] }&#39;</span><span class="fu"> </span><span class="ch">$&lt;</span><span class="fu"> &gt; </span><span class="ch">$@</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true"></a><span class="dv">$(CACHE)/post/posts:</span><span class="dt"> clean_posts </span><span class="ch">$(</span><span class="dt">POSTS_BUILD_YAML</span><span class="ch">)</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true"></a>    <span class="ch">@</span><span class="fu">for post_ref in </span><span class="ch">$(</span><span class="dt">POSTS_REFS</span><span class="ch">)</span><span class="fu">; do  </span><span class="ch">\</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true"></a><span class="fu">        yq -c </span><span class="st">&quot;. | .ref = \&quot;</span><span class="ch">$$</span><span class="fu">post_ref\</span><span class="st">&quot;&quot;</span><span class="fu"> </span><span class="ch">$(</span><span class="dt">CACHE</span><span class="ch">)</span><span class="fu">/post/</span><span class="ch">$$</span><span class="fu">post_ref.yaml &gt;&gt; </span><span class="ch">$(</span><span class="dt">CACHE</span><span class="ch">)</span><span class="fu">/post/posts; </span><span class="ch">\</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true"></a><span class="fu">    done</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true"></a><span class="dv">$(CACHE)/post/%.md:</span><span class="dt"> src/post/%.md</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true"></a>    <span class="ch">@</span><span class="fu">sed -n -e </span><span class="st">&#39;1d;/---/,</span><span class="ch">$$</span><span class="st">p&#39;</span><span class="fu"> </span><span class="ch">$&lt;</span><span class="fu"> | sed </span><span class="st">&#39;1d&#39;</span><span class="fu"> &gt; </span><span class="ch">$@</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true"></a><span class="co"># Extract yaml frontmatter from posts</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true"></a><span class="dv">$(CACHE)/post/%.yaml:</span><span class="dt"> src/post/%.md</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true"></a>    <span class="ch">@</span><span class="fu">sed -n -e </span><span class="st">&#39;/---/,/---/p&#39;</span><span class="fu"> </span><span class="ch">$&lt;</span><span class="fu"> | sed </span><span class="st">&#39;1d;</span><span class="ch">$$</span><span class="st">d&#39;</span><span class="fu"> &gt; </span><span class="ch">$@</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true"></a><span class="co"># Render the markdown to HTML with pandoc</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true"></a><span class="dv">$(CACHE)/post/%.html:</span><span class="dt"> </span><span class="ch">$(</span><span class="dt">CACHE</span><span class="ch">)</span><span class="dt">/post/%.md</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true"></a>    pandoc --katex --quiet <span class="ch">$&lt;</span> -o <span class="ch">$@</span></span></code></pre></div>
<h3 id="tag-generation">Tag Generation</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode makefile"><code class="sourceCode makefile"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a><span class="co"># Build tag files from the frontmatter of each post</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true"></a><span class="co"># </span><span class="al">TODO</span><span class="co">: al momento questo non è troppo bll per un makefile, sarebbe meglio trasformarla in una regola PHONY</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true"></a><span class="dv">$(CACHE)/tags/%.tag:</span><span class="dt"> </span><span class="ch">$(</span><span class="dt">CACHE</span><span class="ch">)</span><span class="dt">/post/%.yaml</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true"></a>    <span class="ch">@</span><span class="fu">yq -r </span><span class="st">&#39;.tags[]&#39;</span><span class="fu"> </span><span class="ch">$&lt;</span><span class="fu"> 2&gt; /dev/null | </span><span class="ch">\</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true"></a><span class="fu">        while read line; do </span><span class="ch">\</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true"></a><span class="fu">            echo </span><span class="ch">$*</span><span class="fu"> &gt;&gt; </span><span class="ch">$(</span><span class="dt">CACHE</span><span class="ch">)</span><span class="fu">/tags/</span><span class="ch">$$</span><span class="fu">line.tag; </span><span class="ch">\</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true"></a><span class="fu">        done</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true"></a><span class="co"># Generate tag pages</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true"></a><span class="ot">.PHONY:</span><span class="dt"> tags</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true"></a><span class="dv">tags:</span><span class="dt"> clean_tags </span><span class="ch">$(</span><span class="dt">POSTS_BUILD_TAGS</span><span class="ch">)</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true"></a>    <span class="ch">@</span><span class="fu">find </span><span class="ch">$(</span><span class="dt">TAGS_PATH</span><span class="ch">)</span><span class="fu"> | </span><span class="ch">\</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true"></a><span class="fu">        xargs basename -s .tag | </span><span class="ch">\</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true"></a><span class="fu">        while read tagname; do  </span><span class="ch">\</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true"></a><span class="fu">            jq -nR </span><span class="st">&quot;{ name: \&quot;</span><span class="ch">$$</span><span class="fu">tagname\</span><span class="st">&quot;, refs: [inputs | select(length&gt;0)]}&quot;</span><span class="fu"> </span><span class="ch">$(</span><span class="dt">CACHE</span><span class="ch">)</span><span class="fu">/tags/</span><span class="ch">$$</span><span class="fu">tagname.tag &gt; </span><span class="ch">$(</span><span class="dt">CACHE</span><span class="ch">)</span><span class="fu">/tags/</span><span class="ch">$$</span><span class="fu">tagname.json; </span><span class="ch">\</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true"></a><span class="fu">            gotemplater -d </span><span class="ch">$(</span><span class="dt">CACHE</span><span class="ch">)</span><span class="fu">/tags/</span><span class="ch">$$</span><span class="fu">tagname.json layouts/tag.html | </span><span class="ch">\</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true"></a><span class="fu">                gotemplater -c - layouts/_base.html &gt; </span><span class="ch">$(</span><span class="dt">OUT</span><span class="ch">)</span><span class="fu">/tags/</span><span class="ch">$$</span><span class="fu">tagname.html; </span><span class="ch">\</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true"></a><span class="fu">        done</span></span></code></pre></div>
<h3 id="cleaning">Cleaning</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode makefile"><code class="sourceCode makefile"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="ot">.PHONY:</span><span class="dt"> clean_posts</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true"></a><span class="dv">clean_posts:</span><span class="dt"> </span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true"></a>    rm -f <span class="ch">$(</span><span class="dt">CACHE</span><span class="ch">)</span>/post/posts</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true"></a>    printf <span class="st">&quot;\n&quot;</span> &gt; <span class="ch">$(</span><span class="dt">CACHE</span><span class="ch">)</span>/post/posts</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true"></a><span class="ot">.PHONY:</span><span class="dt"> clean_tags</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true"></a><span class="dv">clean_tags:</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true"></a>    rm -f <span class="ch">$(</span><span class="dt">CACHE</span><span class="ch">)</span>/tags/*</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true"></a><span class="ot">.PHONY:</span><span class="dt"> clean</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true"></a><span class="dv">clean:</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true"></a>    rm -rf <span class="ch">$(</span><span class="dt">OUT</span><span class="ch">)</span>/</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true"></a>    rm -rf <span class="ch">$(</span><span class="dt">CACHE</span><span class="ch">)</span>/</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true"></a>    mkdir -p <span class="ch">$(</span><span class="dt">OUT</span><span class="ch">)</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true"></a>    mkdir -p <span class="ch">$(</span><span class="dt">OUT</span><span class="ch">)</span>/post</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true"></a>    mkdir -p <span class="ch">$(</span><span class="dt">OUT</span><span class="ch">)</span>/page</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true"></a>    mkdir -p <span class="ch">$(</span><span class="dt">OUT</span><span class="ch">)</span>/tags</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true"></a>    mkdir -p <span class="ch">$(</span><span class="dt">CACHE</span><span class="ch">)</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true"></a>    mkdir -p <span class="ch">$(</span><span class="dt">CACHE</span><span class="ch">)</span>/post</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true"></a>    mkdir -p <span class="ch">$(</span><span class="dt">CACHE</span><span class="ch">)</span>/tags</span></code></pre></div>


</article>

    </main>
    <footer>
        &copy; Antonio De Lucreziis 2020

        
    </footer>

    <script src="static/js/ux.js"></script>
</body>

</html>